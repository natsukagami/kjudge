{{ define "inner-title" }}Messages{{ end }}

{{ define "content" }}
<div class="text-4xl py-4"><b>{{.Contest.Name}}</b>: Messages</div>

<div class="text-xl my-2 text-gray-800 timer" data-start="{{.Contest.StartTime | time}}"
    data-end="{{.Contest.EndTime | time}}"><span class="font-semibold"></span></div>

<div class="p-2">
    {{ range .Messages }}
    {{ with .Announcement }}
    {{ template "announcement" . }}
    {{ end }}
    {{ with .Clarification }}
    {{ template "clarification" . }}
    {{ end }}
    {{ else }}
    <div class="text-center">No messages</div>
    {{ end }}
</div>
{{ end }}

{{ define "clarification" }}
<div class="p-2 bg-gray-200 rounded border hover:bg-blue-200 clarification" data-id="{{.ID}}">
    <div class="flex flex-row justify-between">
        <div>
            <div class="text-lg">
                {{ if .ProblemID.Valid }}
                {{ with (index $.Problems .ProblemID.Int64) }}
                {{ $problemLink := .AdminLink }}
                re:
                <a href="{{$problemLink}}" class="font-semibold hover:text-blue-600">
                    {{.Name}}. {{.DisplayName}}
                </a>
                {{ end }}
                {{ else }}
                General Question
                {{ end }}
            </div>
        </div>
        <div class="text-right">
            <div class="text-sm italic display-time" data-time="{{.UpdatedAt | time}}"></div>
        </div>
    </div>
    <pre class="whitespace-pre-wrap my-2">{{- printf "%s" .Content -}}</pre>
    {{ if .Response }}
    <div>
        <div class="text-lg">Response:</div>
        <pre class="whitespace-pre-wrap mt-1">{{- printf "%s" .Content -}}</pre>
    </div>
    {{ else }}
    <div class="mt-1 text-bold">No responses yet.</div>
    {{ end }}
</div>
{{ end }}

{{ define "announcement" }}
<div class="p-2 border rounded-sm bg-gray-200 hover:bg-blue-200 my-2 announcement" data-id="{{.ID}}">
    <div class="flex flex-row justify-between">
        <div class="text-lg">
            {{ if .ProblemID.Valid }}
            {{ with (index $.Problems .ProblemID.Int64) }}
            Problem
            <span class="font-semibold">{{.Name}}. {{.DisplayName}}</span>
            {{ end }}
            {{ else }}
            <span class="font-semibold">General Announcement</span>
            {{ end }}
        </div>
        <div class="text-sm italic display-time" data-time="{{.CreatedAt | time}}"></div>
    </div>
    <div class="mt-2 overflow-y-auto whitespace-normal">
        {{ printf "%s" .Content }}
    </div>
</div>
{{ end }}
